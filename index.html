<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#fff7ed">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
    <title>3D Cube IQ - Brain Trainer</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://connect.facebook.net/en_US/fbinstant.7.1.js" async></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>

    <div id="canvas-container" class="fixed inset-0"></div>

    <!-- Game HUD (redesigned) -->
    <div id="hud" class="hud-wrap hidden">
        <div class="hud-top">
            <button type="button" id="btn-game-back" class="hud-back" title="Home" aria-label="Back to Home">
                <span class="hud-back-icon">‚åÇ</span>
                <span class="hud-back-text">Home</span>
            </button>
            <div class="hud-stats">
                <div class="hud-stat">
                    <span class="hud-stat-label">Score</span>
                    <span id="score-val" class="hud-stat-val">0</span>
                    <span id="score-bonus" class="score-bonus hidden"></span>
                </div>
                <div class="hud-stat">
                    <span class="hud-stat-label">Best</span>
                    <span id="best-score-val" class="hud-stat-val">0</span>
                </div>
                <div class="hud-stat">
                    <span class="hud-stat-label">Level</span>
                    <span id="level-val" class="hud-stat-val">1</span>
                </div>
                <div class="hud-stat hud-stat-progress">
                    <span class="hud-stat-label">Q</span>
                    <span id="progress-val" class="hud-stat-val">1/6</span>
                </div>
            </div>
            <div class="hud-timer">
                <span class="hud-timer-label">Time</span>
                <div class="hud-timer-value-wrap">
                    <span id="question-timer-text" class="hud-timer-num">90</span>
                    <div class="hud-timer-track">
                        <div id="question-timer-fill" class="hud-timer-fill"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="ui-layer">
        
        <!-- Homepage -->
        <div id="homepage" class="interactive">
            <div class="glass-card home-card">
                <h1 class="logo">CUBE IQ</h1>
                <p class="tagline">Brain Trainer</p>
                <div class="home-stats">
                    <div class="home-stats-normal" id="home-stats-normal">
                        <div class="home-stat"><span class="home-stat-label">‡∂∏‡∑î‡∂Ω‡∑î ‡∂Ω‡∂ö‡∑î‡∂´‡∑î / Total Mark</span><span id="home-total-normal" class="home-stat-value">0</span></div>
                        <div class="home-stat"><span class="home-stat-label">IQ</span><span id="home-iq-normal" class="home-stat-value">--</span></div>
                        <div class="home-stat home-stat-coins"><span class="home-stat-label">‡∂ö‡∑è‡∑É‡∑í / Coins</span><span id="home-coins-normal" class="home-stat-value">0</span></div>
                    </div>
                </div>
                <p class="desc">‡∂ú‡∑ê‡∂ß‡∂Ω‡∑î‡∑Ä ‡∑Ä‡∂ª‡∑ä‡∂ú‡∂∫ ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂±</p>
                <div class="game-types">
                    <div class="game-type-card" onclick="doAfterPress(function(){ goToGame('patterns'); })">
                        <div class="game-icon">üî¢</div>
                        <div class="game-name">Number Patterns</div>
                        <div class="game-name-si">‡∑É‡∂Ç‡∂õ‡∑ä‚Äç‡∂∫‡∑è ‡∂ª‡∂ß‡∑è</div>
                    </div>
                    <div class="game-type-card" onclick="doAfterPress(function(){ goToGame('mathPuzzles'); })">
                        <div class="game-icon">üß©</div>
                        <div class="game-name">Math Puzzles</div>
                        <div class="game-name-si">‡∂ú‡∂´‡∑í‡∂≠ ‡∂¥‡∑ô‡∑Ñ‡∑ô‡∑Ö‡∑í‡∂ö‡∑è</div>
                    </div>
                    <div class="game-type-card" onclick="doAfterPress(function(){ goToGame('mathVerify'); })">
                        <div class="game-icon">‚úì‚úó</div>
                        <div class="game-name">Math Verification</div>
                        <div class="game-name-si">‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∂ú‡∂´‡∑í‡∂≠ ‡∂ú‡∑ê‡∂ß‡∂Ω‡∑î ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏</div>
                    </div>
                    <div class="game-type-card" onclick="doAfterPress(function(){ goToGame('calculator'); })">
                        <div class="game-icon">üßÆ</div>
                        <div class="game-name">Calculator Cube</div>
                        <div class="game-name-si">Calculator Cube</div>
                    </div>
                    <div class="game-type-card" onclick="doAfterPress(function(){ goToGame('colorCube'); })">
                        <div class="game-icon">üé®</div>
                        <div class="game-name">Color Cube</div>
                        <div class="game-name-si">‡∂¥‡∑è‡∂ß ‡∂ù‡∂±‡∂ö‡∂∫</div>
                    </div>
                </div>
                <div class="home-gifts" id="home-gifts">
                    <span class="home-gifts-label">üéÅ ‡∂≠‡∑ë‡∂ú‡∑í / Gifts</span>
                    <div class="gift-slots" id="gift-slots"></div>
                </div>
                <button type="button" class="btn-marketplace" onclick="doAfterPress(openMarketplace)">
                    üé® Skin Marketplace
                </button>
            </div>
        </div>

        <!-- Skin Marketplace -->
        <div id="marketplace" class="hidden interactive">
            <div class="glass-card marketplace-card">
                <h2 class="marketplace-title">üé® Cube Skin Marketplace</h2>
                <div class="marketplace-coins">
                    <span class="marketplace-coins-label">‡∂ö‡∑è‡∑É‡∑í / Coins</span>
                    <span id="marketplace-coins-val" class="marketplace-coins-val">0</span>
                </div>
                <div id="marketplace-grid" class="marketplace-grid"></div>
                <button type="button" class="btn-back" onclick="doAfterPress(closeMarketplace)">‚Üê Back to Home</button>
            </div>
        </div>

        <!-- Results fullscreen (IQ + Total Mark ‚Äì simple big numbers) -->
        <div id="meter-fullscreen" class="meter-fullscreen hidden">
            <div class="meter-fullscreen-inner">
                <div class="result-block result-iq">
                    <span class="result-label">IQ</span>
                    <span id="home-iq" class="result-value">--</span>
                </div>
                <div class="result-block result-score">
                    <span class="result-label">‡∂∏‡∑î‡∂Ω‡∑î ‡∂Ω‡∂ö‡∑î‡∂´‡∑î / Total Mark</span>
                    <span id="home-best-score" class="result-value">0</span>
                </div>
            </div>
        </div>

        <!-- Gift opened: full-screen 3D box, then reward card -->
        <div id="gift-opened-overlay" class="gift-opened-overlay hidden interactive">
            <div id="gift-box-3d-container" class="gift-box-3d-fullscreen">
                <p class="gift-box-tap-hint" id="gift-box-tap-hint">Tap to open / ‡∂≠‡∂ß‡∑ä‡∂ß‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
            </div>
            <div class="glass-card gift-opened-card gift-opened-reward-card hidden" id="gift-opened-reward-card">
                <p class="gift-opened-title">üéÅ Gift Opened!</p>
                <p class="gift-opened-reward" id="gift-opened-reward">+10 ‡∂ö‡∑è‡∑É‡∑í</p>
                <p class="gift-opened-skin hidden" id="gift-opened-skin"></p>
                <button type="button" class="btn-close-gift" onclick="closeGiftOpened()">OK</button>
            </div>
        </div>

        <!-- Level up celebration -->
        <div id="level-up-overlay" class="hidden interactive">
            <div id="confetti-container" style="position:absolute;inset:0;overflow:hidden;"></div>
            <div id="level-up-coin-scatter" class="level-up-coin-scatter" aria-hidden="true"></div>
            <div class="level-up-card">
                <p class="level-up-title">üéâ Level Up!</p>
                <p class="level-up-msg">Congratulations! / ‡∑É‡∑î‡∂∂ ‡∂¥‡∑ê‡∂≠‡∑î‡∂∏‡∑ä!</p>
                <p class="level-up-num" id="level-up-num">2</p>
                <div class="level-up-rewards">
                    <div class="level-up-coins">
                        <span class="level-up-coins-label">+8 ‡∂ö‡∑è‡∑É‡∑í</span>
                        <span id="level-up-coins-val" class="level-up-coins-val">8</span>
                    </div>
                    <button type="button" class="btn-level-up-ad" id="btn-level-up-ad">‡∂á‡∂©‡∑ä ‡∂∂‡∂Ω‡∑è 3√ó ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑ä‡∂± (24 ‡∂ö‡∑è‡∑É‡∑í)</button>
                </div>
                <div class="level-up-gift-wrap">
                    <span class="level-up-gift-icon">üéÅ</span>
                    <p class="level-up-gift" id="level-up-gift">‡∂≠‡∑ë‡∂ú‡∑í ‡∂Ω‡∑ê‡∂∂‡∑î‡∂´‡∑è! / Gift received!</p>
                </div>
                <button type="button" class="btn-next-level" id="btn-next-level">Next Level ‚Üí</button>
            </div>
        </div>

        <!-- Color Cube: net view (6 faces flat) -->
        <div id="color-cube-net-screen" class="color-cube-net-screen hidden">
            <p class="color-cube-net-hint">‡∂ù‡∂±‡∂ö‡∂∫‡∑ö ‡∂∏‡∑î‡∑Ñ‡∑î‡∂´‡∂≠‡∑ä ‡∂∂‡∂Ω‡∂±‡∑ä‡∂± / Memorize the faces</p>
            <div class="color-cube-net">
                <div class="net-row">
                    <div class="net-cell empty"></div>
                    <div class="net-cell net-face" data-face="4" id="net-face-4"></div>
                    <div class="net-cell empty"></div>
                    <div class="net-cell empty"></div>
                </div>
                <div class="net-row">
                    <div class="net-cell net-face" data-face="1" id="net-face-1"></div>
                    <div class="net-cell net-face" data-face="3" id="net-face-3"></div>
                    <div class="net-cell net-face" data-face="0" id="net-face-0"></div>
                    <div class="net-cell net-face" data-face="2" id="net-face-2"></div>
                </div>
                <div class="net-row">
                    <div class="net-cell empty"></div>
                    <div class="net-cell net-face" data-face="5" id="net-face-5"></div>
                    <div class="net-cell empty"></div>
                    <div class="net-cell empty"></div>
                </div>
            </div>
            <button type="button" class="btn-net-continue" id="btn-net-continue">‡∂ù‡∂±‡∂ö‡∂∫ ‡∑É‡∑ë‡∂Ø‡∑ô‡∂∫‡∑í / Form cube</button>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="hidden interactive">
            <div class="glass-card start-card">
                <h1>CUBE IQ</h1>
                <p id="selected-game-name" class="tagline" style="margin-bottom:1rem"></p>
                <button onclick="doAfterPress(startGame)" class="btn-start">START GAME</button>
                <button onclick="doAfterPress(backToHome)" class="btn-back">‚Üê Back to Home</button>
            </div>
        </div>

        <!-- Number Patterns: 2D pattern card (no cube texture) -->
        <div id="number-pattern-card" class="number-pattern-card hidden">
            <p class="number-pattern-label">‡∂ª‡∂ß‡∑è‡∑Ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂± / Find the pattern</p>
            <div class="number-pattern-grid">
                <div class="number-pattern-cell" id="pattern-cell-0">?</div>
                <div class="number-pattern-cell" id="pattern-cell-1">?</div>
                <div class="number-pattern-cell" id="pattern-cell-2">?</div>
                <div class="number-pattern-cell" id="pattern-cell-3">?</div>
            </div>
        </div>

        <!-- Options Container -->
        <div id="game-controls" class="hidden interactive">
            <p id="color-cube-question" class="color-cube-question hidden"></p>
            <div id="options-grid"></div>
            <div class="lifeline-row">
                <button type="button" class="btn-lifeline" id="btn-5050">50:50</button>
                <button type="button" class="btn-lifeline" id="btn-extra-time">+ ‡∂ö‡∑è‡∂Ω‡∂∫</button>
                <button type="button" class="btn-lifeline" id="btn-skip-hard">‡∂Ö‡∂∏‡∑è‡∂ª‡∑î ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± ‡∂∏‡∂ü‡∑Ñ‡∂ª‡∑í‡∂±‡∑ä‡∂±</button>
            </div>
        </div>

        <!-- Skip question: watch ad to skip -->
        <div id="skip-question-ad-screen" class="hidden interactive" style="position:absolute;inset:0;display:flex;padding:1.5rem;">
            <div class="glass-card">
                <p class="skip-msg" id="skip-question-msg">‡∂á‡∂©‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂∂‡∂Ω‡∑è ‡∂∏‡∑ô‡∂∏ ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫ ‡∂∏‡∂ú‡∑Ñ‡∂ª‡∑í‡∂±‡∑ä‡∂±.<br>Watch an ad to skip this question.</p>
                <div class="skip-buttons">
                    <button type="button" class="btn-watch-ad-skip" id="btn-watch-ad-skip">‡∂á‡∂©‡∑ä ‡∂ë‡∂ö ‡∂∂‡∂Ω‡∂±‡∑ä‡∂± / Watch ad</button>
                    <button type="button" class="btn-cancel-skip" id="btn-cancel-skip">‡∂Ö‡∑Ä‡∂Ω‡∂Ç‡∂ú‡∑î / Cancel</button>
                </div>
            </div>
        </div>

        <!-- Ad offer: watch ad to play again -->
        <div id="ad-offer-screen" class="hidden interactive" style="position:absolute;inset:0;display:flex;padding:1.5rem;">
            <div class="glass-card ad-offer-card">
                <p class="ad-offer-title">GAME OVER!</p>
                <div class="ad-offer-score" id="ad-offer-score">0</div>
                <p class="ad-offer-msg">‡∂á‡∂©‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂∂‡∂Ω‡∑è ‡∑Ä‡∑ô‡∂±‡∂≠‡∑ä ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫‡∂ö‡∑ä ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑ä‡∂±.<br>Watch an ad to get a different question!</p>
                <div class="ad-offer-buttons">
                    <button type="button" class="btn-watch-ad" id="btn-watch-ad">‡∂á‡∂©‡∑ä ‡∂ë‡∂ö ‡∂∂‡∂Ω‡∂±‡∑ä‡∂± / Watch ad</button>
                    <button type="button" class="btn-skip-ad" id="btn-skip-ad">‡∂∏‡∂ü ‡∂Ö‡∂ª‡∑í‡∂±‡∑ä‡∂± / Skip</button>
                </div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="over-screen" class="hidden interactive">
            <div class="glass-card over-card">
                <h2>GAME OVER!</h2>
                <div id="final-score">0</div>
                <p id="iq-msg"></p>
                <button onclick="doAfterPress(startGame)" class="btn-retry">TRY AGAIN</button>
                <button onclick="doAfterPress(backToHome)" class="btn-back" style="margin-top:0.5rem">‚Üê Back to Home</button>
            </div>
        </div>

    </div>

    <script src="fb-instant.js"></script>
    <script src="number-patterns-questions.js"></script>
    <script src="skin-marketplace.js"></script>
    <script src="game-storage.js"></script>
    <script src="script.js"></script>
</body>
</html>
